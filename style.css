/* =========================================================
   Learn Japanese â€” Minimal, responsive UI (dark-friendly)
   Works with index.html + script.js (no-manifest folder scan)
   ========================================================= */

:root{
  --bg: #0b0e13;
  --bg-soft: #121824;
  --card: #151c28;
  --text: #e7edf7;
  --muted: #a8b3c7;
  --accent: #5aa9ff;
  --accent-2: #7bd389;
  --danger: #ff6b6b;
  --warning: #f8c14b;
  --border: #223049;
  --shadow: 0 8px 24px rgba(0,0,0,.24);
  --radius: 14px;
}

@media (prefers-color-scheme: light){
  :root{
    --bg: #f7fbff;
    --bg-soft: #eef5ff;
    --card: #ffffff;
    --text: #0a1a33;
    --muted: #50627e;
    --accent: #2267e3;
    --accent-2: #0aa35b;
    --danger: #cc2936;
    --warning: #b77e00;
    --border: #d6e2f3;
    --shadow: 0 8px 24px rgba(0,0,0,.08);
  }
}

*{ box-sizing: border-box; }
html, body { height:100%; }
body{
  margin:0;
  font: 15px/1.45 system-ui, -apple-system, Segoe UI, Roboto, Helvetica, Arial, "Apple Color Emoji","Segoe UI Emoji";
  color: var(--text);
  background: radial-gradient(1200px 900px at 10% -10%, #20304a 0%, transparent 60%),
              radial-gradient(1200px 900px at 90% -10%, #13233b 0%, transparent 60%),
              var(--bg);
}

/* Layout */
.layout{
  display:grid;
  grid-template-columns: 260px 1fr;
  min-height:100vh;
}
.sidebar{
  position:sticky; top:0;
  padding:16px;
  background: linear-gradient(180deg, var(--bg-soft), transparent 220px), transparent;
  border-right:1px solid var(--border);
  min-height:100vh;
}
.sidebar h2{ margin:6px 0 10px; font-size:18px; }
.sidebar button{
  width:100%; text-align:left; margin-bottom:8px;
}
.main-content{ min-width:0; }
.topbar{
  display:flex; justify-content:space-between; align-items:center;
  padding:10px 16px; border-bottom:1px solid var(--border);
  position:sticky; top:0; background:linear-gradient(180deg,var(--bg),rgba(0,0,0,0));
  z-index:4;
}
.crumbs{ opacity:.9; font-weight:600; }
.crumbs .sep{ margin:0 6px; opacity:.5; }

.hidden{ display:none !important; }
.muted{ color: var(--muted); }

/* Cards & sections */
.card{
  background: var(--card);
  border:1px solid var(--border);
  border-radius: var(--radius);
  box-shadow: var(--shadow);
  padding:14px;
  margin-top:12px;
}
.level-head h2{ margin:12px 0 0; }
.lesson-list{
  display:grid;
  grid-template-columns: repeat(auto-fill, minmax(140px,1fr));
  gap:10px;
}
.lesson-item{
  padding:12px 10px; border:1px solid var(--border); border-radius:12px;
  background:linear-gradient(180deg, #1a2436, #131a29);
  cursor:pointer; user-select:none; text-align:center; font-weight:600;
  transition: transform .12s ease, border-color .12s ease;
}
.lesson-item:hover{ transform: translateY(-1px); border-color:#3a5a8a; }
.lesson-item:active{ transform: translateY(0); }

/* Tabs */
.lesson-bar{ display:flex; gap:12px; align-items:center; justify-content:space-between; }
.lesson-meta{ display:flex; flex-direction:column; gap:6px; }
.lesson-tabs{ display:flex; gap:8px; flex-wrap:wrap; }
.tab-btn{
  border:1px solid var(--border);
  background: #121a2a;
  color: var(--text);
  padding:8px 12px; border-radius:10px; font-weight:600;
}
.tab-btn[aria-selected="true"]{
  outline:2px solid #3a6bff50;
  background:#14234a; border-color:#3657a5;
}
.tab-pane{ margin-top:10px; }

/* Buttons (global) */
button{
  appearance: none; border:1px solid var(--border);
  background: #0f1726; color: var(--text);
  padding:8px 10px; border-radius:10px; cursor:pointer;
  font-weight:600; transition: transform .12s ease, background .12s ease, border-color .12s ease, box-shadow .12s ease;
}
button:hover{ transform: translateY(-1px); background:#15203a; }
button:active{ transform: translateY(0); }
button.danger{ border-color: #3e2023; background:#261013; color:#ffd9de; }
button.save{ border-color:#194626; background:#0f2218; color:#b9ffd1; }

button.chip{
  border-radius:999px; padding:7px 12px;
  background:#0f1a2b; border-color:#1c2a47; white-space:nowrap;
}
button.chip:hover{ background:#132340; }

/* Video Module */
.file-button-row{
  display:flex; gap:8px; flex-wrap:wrap;
  overflow:auto; padding-bottom:6px;
}
.video-grid{
  display:grid; grid-template-columns: repeat(auto-fill, minmax(220px,1fr));
  gap:12px; margin-top:10px;
}
.video-card{
  text-align:left; padding:8px; background:#0e1524; border-color:#1b2943;
}
.video-card .video-thumb{
  position:relative; border-radius:10px; overflow:hidden; border:1px solid var(--border);
}
.video-card img{
  display:block; width:100%; height:140px; object-fit:cover;
}
.play-badge{
  position:absolute; inset:auto 8px 8px auto;
  background: #17233c; color:#fff; padding:4px 8px; border-radius:999px; border:1px solid #2c3d62;
  font-weight:700; font-size:12px;
}
.yt-wrap{ position:relative; width:100%; aspect-ratio:16/9; border-radius:10px; overflow:hidden; border:1px solid var(--border); }

/* Vocab & Practice */
.flashcard{
  margin-top:10px; padding:18px; border-radius:16px;
  background: radial-gradient(600px 260px at -10% -10%, #202f4d 0%, transparent 60%), #0e1423;
  border:1px solid #283a5f;
  font-size:20px; text-align:center;
}
#options{
  list-style:none; padding:0; margin:12px 0 0;
  display:grid; grid-template-columns: repeat(auto-fit, minmax(140px,1fr)); gap:10px;
}
#options li button{
  width:100%; padding:10px 12px; border-radius:12px; text-align:center;
  border-color:#263656; background:#0c1321;
}
#options li button.is-correct{ border-color:#1b5a2c; background:#0e2a18; color:#bcffc9; }
#options li button.is-wrong{ border-color:#5a1b1b; background:#2a0e0e; color:#ffd0d0; }

.dual-grid{ display:grid; grid-template-columns:1fr 1fr; gap:10px; margin-top:10px; }
.dual-grid > div{ display:grid; grid-template-columns:1fr; gap:8px; }
.dual-grid button{ padding:10px; }

.deck-progress{
  position:relative; background:#0e1524; border:1px solid var(--border);
  height:12px; border-radius:999px; overflow:hidden;
}
.deck-progress + .deck-progress-text{ margin-top:6px; text-align:right; font-size:12px; color:var(--muted); }
.deck-progress-bar{
  height:100%; width:0%; background: linear-gradient(90deg, #2f7bff, #7bd389);
}

.practice-actions{ display:flex; flex-wrap:wrap; gap:8px; margin-top:10px; }

/* Learn Notes */
.learn-note-card{ margin-top:10px; }
.learn-note-row{ display:flex; align-items:center; justify-content:space-between; gap:8px; }
.learn-note-label{ font-weight:700; }
.learn-note-status{ font-size:12px; }
.learn-note-input{
  margin-top:6px; width:100%; min-height:84px;
  background:#0e1524; color:var(--text); border:1px solid var(--border);
  border-radius:12px; padding:10px; resize:vertical;
}

/* Write / Grammar inputs */
.pg-input-row{ display:flex; flex-wrap:wrap; gap:8px; align-items:center; margin-top:10px; }
.pg-input, .make-textarea{
  flex:1 1 260px; padding:10px 12px; border-radius:10px;
  background:#0e1524; color:var(--text); border:1px solid var(--border);
}
.pg-feedback{ margin-top:8px; min-height:20px; }
.ok-inline{ color:#a7ffbe; font-weight:700; }
.error-inline{ color:#ffb2b2; font-weight:700; }

/* Progress tables */
.table-wrap{ overflow:auto; border:1px solid var(--border); border-radius:12px; }
.progress-table{ width:100%; border-collapse:collapse; }
.progress-table th, .progress-table td{
  padding:10px 12px; border-bottom:1px solid var(--border); white-space:nowrap;
}
.progress-table thead th{ background:#0f1727; text-align:left; }

/* Marked / SignWord */
.marked-item, .sw-item{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; border:1px solid var(--border); background:#0e1524; padding:10px 12px; border-radius:12px; margin-bottom:8px;
}

/* Toast */
.toast{
  position:fixed; left:50%; bottom:18px; transform: translate(-50%, 30px);
  background:#0f1c31; color:#fff; border:1px solid #27406e;
  padding:10px 14px; border-radius:999px; box-shadow: var(--shadow);
  opacity:0; pointer-events:none; transition: opacity .18s ease, transform .18s ease;
  z-index:10;
}
.toast.show{ opacity:1; transform: translate(-50%, 0); }

/* Auth */
.auth-gate{
  min-height:100vh; display:grid; place-items:center; padding:16px;
}
.auth-card{
  width:min(560px, 92vw); background:var(--card); border:1px solid var(--border);
  border-radius:16px; padding:18px; box-shadow: var(--shadow); text-align:center;
}

/* Code inline */
code{ background:#0c1424; border:1px solid var(--border); padding:1px 6px; border-radius:6px; color:#c6d6ff; }

/* Focus visibility */
:focus-visible{
  outline: 2px solid #4d74ff;
  outline-offset: 2px;
  border-radius: 8px;
}

/* Small helpers */
#score{ font-weight:700; display:flex; gap:10px; align-items:center; }
.error{ color: var(--danger); }

/* Responsive tweaks */
@media (max-width: 980px){
  .layout{ grid-template-columns: 1fr; }
  .sidebar{ position:relative; min-height:auto; border-right:none; border-bottom:1px solid var(--border); }
  .topbar{ position:sticky; top:0; }
}

/* --- Video lightbox (moderate large) --- */
.lightbox{
  position: fixed; inset: 0; z-index: 50;
  display: grid; place-items: center;
}
.lightbox-backdrop{
  position: absolute; inset: 0;
  background: rgba(0,0,0,.6);
  backdrop-filter: blur(2px);
}
.lightbox-inner{
  position: relative; z-index: 1;
  width: min(920px, 94vw);
}
.lightbox-head{
  display:flex; align-items:center; justify-content:space-between;
  margin-bottom:10px;
}
.lightbox-close{
  border:1px solid var(--border);
  background:#0f1726; color: var(--text);
  padding:6px 10px; border-radius:10px; cursor:pointer;
}
/* Global Back button */
.back {
  background: var(--panel, #101826);
  color: var(--text, #e5e7eb);
  border: 1px solid var(--border, #263041);
  padding: 6px 12px;
  border-radius: 10px;
  cursor: pointer;
  margin: 8px 12px;
}
.back.hidden { display: none; }

/* (Optional) make lightbox explicitly centered if you use it */
.lightbox { position: fixed; inset: 0; z-index: 50; display: grid; place-items: center; }
.lightbox-backdrop { position: absolute; inset: 0; background: rgba(0,0,0,.6); backdrop-filter: blur(2px); }
.lightbox-inner { position: relative; z-index: 1; width: min(920px,94vw); }
.lightbox-head { display:flex; align-items:center; justify-content:space-between; margin-bottom:10px; }
.lightbox-close { border:1px solid var(--border); background:#0f1726; color: var(--text); padding:6px 10px; border-radius:10px; cursor:pointer; }
/* Coming soon message on empty levels */
#lesson-status.coming-soon {
  text-align: center;
  padding: 40px 0;
  font-size: 1.25rem;
  opacity: 0.85;
}
/* Dual MCQ coloring (match single-MCQ styles) */
#options .dual-grid button.is-correct {
  background: var(--ok, #12b886);
  color: #fff;
  border-color: var(--ok, #12b886);
}
#options .dual-grid button.is-wrong {
  background: var(--err, #e03131);
  color: #fff;
  border-color: var(--err, #e03131);
}
#options .dual-grid button[disabled] {
  opacity: 0.6;
  cursor: default;
}

.mix-level { border: 1px solid var(--border, #ddd); border-radius: 10px; padding: 10px; margin: 10px 0; }
.mix-level-head { display:flex; justify-content:space-between; align-items:center; margin-bottom:6px; }
.mix-level-actions button { margin-left:6px; }
.mix-lessons { display:grid; grid-template-columns: repeat(auto-fill, minmax(170px, 1fr)); gap:6px 12px; }
.mix-levels-wrap { margin-top:8px; }
.action-row{display:flex; gap:.5rem; justify-content:flex-end; margin:0 0 .5rem;}
.action-row .danger{background:#3a1a1a;}

/* Unmark modal */
.unmark-list{
  display:grid;
  grid-template-columns: 1fr;
  gap:8px;
  padding:6px 2px;
  max-height:60vh;
  overflow:auto;
}
.unmark-list label{
  display:flex; align-items:center; gap:10px;
  padding:8px 10px; border:1px solid var(--border);
  background:#0e1524; border-radius:10px;
}
.unmark-actions{
  display:flex; align-items:center; justify-content:space-between;
  gap:10px; margin-top:10px;
}
/* Leaderboard (nice look) */
.leaderboard-wrap { margin-top: 8px; }

.leaderboard-table {
  width: 100%;
  border-collapse: separate;
  border-spacing: 0;
}

.leaderboard-table thead th {
  background: #0f1727;
  position: sticky;
  top: 0;
  z-index: 1;
  text-align: left;
}

.leaderboard-table th,
.leaderboard-table td {
  padding: 10px 12px;
  border-bottom: 1px solid var(--border);
  white-space: nowrap;
}

.leaderboard-table tr:hover {
  background: rgba(255,255,255,.03);
}

.leaderboard-table .rank {
  width: 56px;
  text-align: center;
  font-weight: 800;
}

.leaderboard-table .player {
  display: flex;
  align-items: center;
  gap: 10px;
}

.leaderboard-table .avatar {
  width: 28px;
  height: 28px;
  border-radius: 50%;
  display: inline-grid;
  place-items: center;
  font-weight: 800;
  background: #102037;
  border: 1px solid var(--border);
  overflow: hidden;
}
.leaderboard-table .avatar img { width: 100%; height: 100%; object-fit: cover; }

.leaderboard-table .name { font-weight: 700; }
.you-badge {
  font-size: 11px;
  border: 1px solid #2b3b59;
  padding: 2px 6px;
  border-radius: 999px;
  margin-left: 6px;
  color: #a7c0ff;
}

/* medal glow for top 3 */
.leaderboard-table tr.rank-1 { background: linear-gradient(90deg, rgba(255,215,0,.10), transparent); }
.leaderboard-table tr.rank-2 { background: linear-gradient(90deg, rgba(192,192,192,.10), transparent); }
.leaderboard-table tr.rank-3 { background: linear-gradient(90deg, rgba(205,127,50,.10), transparent); }

.leaderboard-table tr.rank-1 .rank::after { content: "ðŸ¥‡"; margin-left: 6px; }
.leaderboard-table tr.rank-2 .rank::after { content: "ðŸ¥ˆ"; margin-left: 6px; }
.leaderboard-table tr.rank-3 .rank::after { content: "ðŸ¥‰"; margin-left: 6px; }

.leaderboard-table .score {
  text-align: right;
  font-variant-numeric: tabular-nums;
}
